/**
 *
 *    000000  0000000000    000000000000000000
 *    000000  0000000000    00000000000000000000
 *    000000      000000    000000   00000  000000
 *    000000      000000    000000     000  000000
 *     00000      000000    000000       0  000000
 *       000      000000    000000          000000
 *         0      000000    000000          000000
 *
 *    Neue Medien - Kunsthochschule Kassel
 *    http://neuemedienkassel.de
 *
 */

@import 'variables';		// variables
@import 'assets';			// base64 encodete Files
@import 'definitions';		// Vorbebaute Definitionen
@import 'lesshat';			// LESSHat 					http://lesshat.com
@import 'ggs';				// golden grid system		http://goldengridsystem.com
@import 'tooltip';


// ! - - - - - - - - - - - - - - - - - - - - - - - - - - - -

body {
	background: @bgColor;
	.aller-light;
	color: @black;
	width: 100%;
}

.placeholder(@color) {
	&::-webkit-input-placeholder { color: @color; }
	&::-moz-placeholder { color: @color; } /* firefox 19+ */
	&:-ms-input-placeholder { color: @color; } /* ie */
	&:-moz-placeholder { color: @color; }

	.transition(~"color .3s ease-in-out");
}

.clearfix() {
	/**
	 * For modern browsers
	 * 1. The space content is one way to avoid an Opera bug when the
	 *    contenteditable attribute is included anywhere else in the document.
	 *    Otherwise it causes space to appear at the top and bottom of elements
	 *    that are clearfixed.
	 * 2. The use of `table` rather than `block` is only necessary if using
	 *    `:before` to contain the top-margins of child elements.
	 */
	&:before,
	&:after {
		content: " "; /* 1 */
		display: table; /* 2 */
	}
	
	&:after {
		clear: both;
	}
	
	/**
	 * For IE 6/7 only
	 * Include this rule to trigger hasLayout and contain floats.
	 */

	*zoom: 1;
}

// temporärer Abstand um bei den Tests im Grid zu starten.
article {
//	margin-top: 7 / @em;
}

iframe {
	max-width: 100%;
}


// ! --- Typo ----------------------------------------------

// für Überschrift 1-3 die "Aller" Font benutzen
h1, h2, h3 {
	.aller;
}

/** 
 * Überschrift ersten Rangs
 */
h1 {
	font-size: @h1Size / @em;
	line-height: @h1LineHeight / @h1Size * 1em;
	margin-bottom: -1 / @h1Size * 1em;
}

/** 
 * Überschrift zweiten Rangs
 */
h2 {
	font-size: @h2Size / @em;
	line-height: @h2LineHeight / @h2Size * 1em;

	// Abstand nach oben
	margin-top: @line / @h2Size * 1em;
}

/**
 * Überschrift dritten Rangs
 *
 * Verwendet die .caps-headline Definition {@see definitions.less}
 */
h3 {
	.caps-headline;
}

// kein Abstand bei aufeinander folgenden Überschriften
h1 + h2,
h2 + h3 {
	margin-top: 0;
}

cite {
	.small-caps;
	font-style: normal;
}

strong {
	.aller();
}

/**
 * Links
 */
a {
	.link();
}

/**
 * Artikel-Element
 */
article {

	// Artikel Überschriftsblock
	header { 
		margin-bottom: @line / @em;

		.detailTooltipHeader();
	}

	// Links im Text
	a {
		.transition(~"color .3s 0 ease-out, border-bottom-color .3s .2s ease-out");
		border-bottom: 1px dashed @gray;

		&:hover,
		&:focus,
		&:active {
			border-bottom: 1px solid @linkHoverBorder;
		}
	}
}

/**
 * Related-Box
 *
 */
aside {
	.list-light(200);
}

// ! --- User Widget ---------------------------------------
#user-widget {
	position: fixed;
	top: (@line / @em);
	right: (@line / @em) * 2;
}


// ! --- Badge ---------------------------------------------

.badge {
	display: inline-block;
	background: @badgeBg;
	padding: (@line / @em) (@badgePaddingHorizontal / @em);
	position: fixed;
	z-index: 999999999;

	.transition(~"padding @{logoSmallTransition} ease-in-out, height @{logoSmallTransition} ease-in-out");

	//.hadow(~"0 2px 5px rgba(0,0,0,.3)");

	// Logo
	> a {
		display: block;
		width: @logoWidth;
		height: @logoHeight;
		background-size: 100%;
		background-repeat: no-repeat;
		background-position: 50% 50%;
		.logo-white;

		text-indent: -99999em;
		.transition(~"width @{logoSmallTransition} ease-in-out, height @{logoSmallTransition} ease-in-out");

		//.transition(~"height 1s ease-in, width 1s ease-in");

		&:hover,
		&:focus,
		&:active,
		&.active {
			.logo-nmcolor;
		}
	}

	nav {
		height: auto;
		overflow: hidden;
		opacity: 1;
		.transition(~"height @{logoSmallTransition} ease-in.out, opacity @{logoSmallTransition} ease-in-out");
	}

	// Navigation
	ul {
		list-style: none;
		margin-top: 7 / @em;

		a {
			.link();
			color: @badgeLinkColor;
			display: block;
		}
	}
}


// ! --- Kalendar ------------------------------------------

.calendar {
	.list-light(200);
	text-align: right;

	h1 {
		margin-top: 0;
	}

	time {
		.mini-caps-light;
		display: block;
	}

	ul {
		margin-bottom: @line / 2 / @em;
	}
}


// ! --- Person --------------------------------------------

.person {
	// clearfix
	overflow: hidden;

	// dummy image
	.img {
		display: block;
		background-color: pink;
		width: 85 / @em;
		height: 85 / @em;
		float: left;
		margin-right: 20 / @em;

		img {
			max-width: 100%;
		}
	}

	h1 {
		margin-top: 21 / @em;
		font-size: @font-size / @em;
	}

	p {
		.mini-light;
	}
}


// ! - - - - - - - - - - - - - - - - - - - - - - - - - - - -


// ! --- Global Page Construction --------------------------

#wrapper {
	margin: 0 @column;
	//overflow: hidden;
	//height: 100%;
	min-height: 100%;
	position: relative;

	.clearfix();

	&:after {
		visibility: hidden;
		display: block;
		font-size: 0;
		content: " ";
		clear: both;
		height: 0;
	}
}

#main,
#layout {
	position: absolute;
	min-height: 100%;
	width: 100%;
}

#main {
	.transition(~"opacity .3s ease-in-out");
	opacity: 1;

	&.loading {
		opacity: 0;
	}
}

.isLoading #main * {
	cursor: default !important;
}

span[data-picture] {
	display: block;

	span {
		display: block;
	}

	img {
		height: auto;
	}
}

#spinner-target {
	height: @spinnerDimension;
	width: @spinnerDimension;
	position: absolute;
	top: 50%;
	left: 50%;
	margin: (@spinnerDimension / -2) 0 0 @spinnerDimension / -2;
	opacity: 0;

	&.active {
		opacity: 1;
	}
}


// ! --- Tooltip -------------------------------------------

@qtipAniOffset: 10;

.qtip {
	position: absolute;
	left: -28000em;
	top: -28000em;
	display: none;
	max-width: 400px;
	min-width: 50px;
	direction: ltr;
	box-shadow: none;
	padding: 0;
	opacity: 0;
}

// Theme
.qtip-default {
	background-color: @bgColor;
}

.qtip-content {
	position: relative;
	padding: @line / @em;
	overflow: hidden;
	word-wrap: break-word;

	header {
		margin-bottom: @line * .5 / @em;

		.detailTooltipHeader();
	}

	a.btn {
		margin-top: @line * .5 / @em;
	}
}

.qtip-focus {
	//display: block;
}

.isLoading .qtip {
	opacity: 0 !important;
}

/*
.qtip[aria-hidden="true"] {

	&.qtip-pos-lb {
		margin-left: -@qtipAniOffset / @em;
	}
	&.qtip-pos-rb {
		margin-left: @qtipAniOffset / @em;
	}
}

.qtip[aria-hidden="false"] {

	&.qtip-pos-lb {
		margin-left: 0;
	}
	&.qtip-pos-rb {
		margin-left: 0;
	}
}
*/


// ! --- Gravity -------------------------------------------

#gravity-container {
	position: relative;
	height: 100%;
}

.gravity {
	position: absolute;
	min-height: 100%;
	//background: darken(@bgColor, 5%);
	.wrapper;

	&> img,
	.gravity-item {
		position: relative;
		display: inline-block;
		opacity: 0;
		.transition(~"opacity .2s ease-in-out");
		z-index: 14000;

		// on item loaded
		&[data-gravity-item].loaded {
			opacity: 1;

			&> a {
				background: @bgColor;

				img {
					min-width: 100%;
					max-width: 100%;
					height: auto;
				}
			}
		}

		&> a {
			position: relative;
			display: block;
			border: none;

			.transition(~"padding .2s ease-out, margin .2s ease-out"); 

			padding: 0;
			margin: 0;

			img {
				display: block;
				//opacity: .5;
			}
		}

		// @todo: fix z-index delay on fade out
		&.has-tooltip {
			z-index: 16000;

			&> a {
				padding: @gravityItemBorder / @em;
				margin: -@gravityItemBorder / @em;
			}

			/*img {
				opacity: 1;
			}*/
		}

		&> section[role="tooltip-content"] {
			display: none;
		}

		/*
		&:hover {
			z-index: 16000;
			&> a {
				background: @bgColor;
				padding: @gravityItemBorder / @em;
				margin: -@gravityItemBorder / @em;
				.transition(~"padding .1s ease-out, margin .1s ease-out");
			}

			img {
				opacity: 1
			}
		}
		*/
	}
}


// ! --- Home ----------------------------------------------

// fallback
.main .gravity {
	.columnsWidth(8, 8);
}

.index {
	.gravity {
		.columnsWidth(8, 6);
	}

	.calendar {
		//float: right;
		position: absolute;
		top: 50%;
		right: 0;
		margin-top: @line * -7 / @em;
		//display: inline-block;
		//vertical-align: middle;
		.wrapper;
		.columnsWidth(8, 2);
	}
}

.portfolio {
	.gravity {
		.columnsWidth(8, 8);
	}
}

.about {
	.gravity {
		.columnsWidth(8, 8);
	}

	article {
		margin: (@line * 4 / @em) + @typoPrefix 0;
		overflow: hidden;
	}

	.statement {
		float: right;
		.columnsWidth(8, 4);
		.wrapper;
		margin-right: 100% / 8 * 1;

		p:last-child {
			margin-bottom: @line * 1 / @em;
		}
	}

	.group-image {
		float: right;
		.wrapper;
		width: 100% / 8 * 3;

		&.loaded img {
			max-width: 100%;
			height: auto;
			display: block;
		}
	}

	.person {
		float: left;
		.columnsWidth(8, 3);
		.wrapper;

		a {
			display: block;

			img {
				display: block;
				.transition(~"opacity .2s ease-out");
				opacity: 1;
			}

			&:hover {
				img {
					opacity: .7;
				}
			}
		}
	}

	.students,
	.alumni {
		float: left;
		.list-columns(2, 500);
		.columnsWidth(8, 3);
		.wrapper;
	}

	.students {
		margin-left: 100% / 8 * 1;
	}

	.alumni {
		margin-right: 100% / 8 * 1;
	}
}

.detail {
	article {
		@articleMarginLeft: 1.5;
		@articleMarginRight: .5;

		@articleMarginCols: @articleMarginLeft + @articleMarginRight;

		@marginTop: (@line * 4 / @em);
		@marginRight: 100% / 8 * @articleMarginRight;
		@marginBottom: @marginTop;
		@marginLeft: 100% / 8 * @articleMarginLeft;

		margin: @marginTop @marginRight 0 @marginLeft;
		padding-bottom: @marginBottom;
		overflow: hidden;

		header  {
			.wrapper;
		}

		section {
			float: left;
			.columnsWidth(8 - @articleMarginCols, 4);
			.wrapper;

			img {
				display: inline-block;
				//margin-top: @line / @em;
				max-width: 100%;
			}

			span[data-picture] {
				display: block;
			}
			span[data-picture],
			p {
				margin-bottom: @line / @em;

				&:last-child {
					margin-bottom: 0;
				}
			}
		}

		aside {
			display: inline-block;
			.columnsWidth(8 - @articleMarginCols, 2);
			.wrapper;
		}
	}
}

.person-info {
	@fullWidth: 6;
	@imageWidth: 1.5;

	// - - - - - - - 
	
	.columnsWidth(8, 6);
	.clearfix();

	> section:first-child {
		float: left;
		.columnsWidth(8, @imageWidth);

		a {
			display: block;
			border: none;
		}

		img {
			max-width: 100%;
			height: auto;
		}
	}

	> section:last-child {
		.columnsWidth(8, @fullWidth - @imageWidth);
		padding: 0 0 (@line / @em) (@line / @em);
		float: left;
	}

	.websites {
		margin-top: @line / @em;

		list-style: none;
	}
}


// ! --- EDITOR --------------------------------------------

.editor {

	.badge {
		padding: (@line / 2 / @em) (@badgePaddingHorizontal / 2 / @em);

		&> a {
			width: @logoSmallWidth;
			height: @logoSmallHeight;
		}

		nav {
			height: 0;
			opacity: 0;
		}
	}
}

/*input[type="search"] {

	&::-webkit-search-cancel-button {
		background-color: red;
		color: red;
	}
}*/

.editor-sidebar {
	position: fixed;
	top: 0;
	right: 0;
	width: 0;
	min-height: 100%;
	max-height: 100%;
	background: @editorSidebarBg;
	.transition(~"width @{editorSlideTransition} ease-in-out");


	&:target,
	&.open {
		.columnsWidth(8, 2);
	}

	.editor-sidebar-content {
		max-height: 100%;
		//position: fixed;
		overflow: scroll;
		.box-sizing(border-box);
		padding: (@line / @em) (@line / @em);

		&> *:nth-child(2) {
			//margin-top: @line * 5 / @em;
		}
	}

	.scrollbox {
		position: relative;
		overflow: auto;
		width: 100%;
		max-height: 100%;
		//margin: 50px auto;

		/*
		background:
			// Shadow covers
			linear-gradient(@editorSidebarBg 30%, rgba(255,255,255,0)),
			linear-gradient(rgba(255,255,255,0), @editorSidebarBg 70%) 0 100%,
		
			// Shadows
			radial-gradient(50% 0, farthest-side, rgba(0,0,0,1), rgba(0,0,0,0)),
			radial-gradient(50% 100%,farthest-side, rgba(0,0,0,1), rgba(0,0,0,0)) 0 100%;

		background:
			// Shadow covers
			linear-gradient(@editorSidebarBg 30%, rgba(255,255,255,0)),
			linear-gradient(rgba(255,255,255,0), @editorSidebarBg 70%) 0 100%,
		
			// Shadows
			radial-gradient(farthest-side at 50% 0, rgba(0,0,0,1), rgba(0,0,0,0)),
			radial-gradient(farthest-side at 50% 100%, rgba(0,0,0,1), rgba(0,0,0,0)) 0 100%;

		background-repeat: no-repeat;
		background-size: 100% 40px, 100% 40px, 100% 14px, 100% 14px;
	
		// Opera doesn't support this in the shorthand
		background-attachment: local, local, scroll, scroll;*/
	}

	header {
		width: 100%;
		background: @editorSidebarBg;
		padding: (@line / @em) (@line / @em) 0;
		.box-sizing(border-box);
	}

	h1, h2, h3 {
		color: #fff;
	}

	a {
		.link();
		color: #fff;
	}

	input[type="search"] {
		outline: none;

		width: 100%;
		-webkit-appearance: textfield;
		background: transparent;
		border: none;
		border-bottom: 1px solid darken(@gray, 20%);

		padding: @line / 2 / @em 0;

		color: @gray;
		.small-caps;

		.placeholder(darken(@gray, 20%));

		.transition(~"border .3s ease-in-out, color .3s ease-in-out");

		&::-webkit-search-decoration {
			-webkit-appearance: none;
		}

		&:focus {
			.placeholder(darken(@gray, 10%));
			border-bottom-color: @gray;
		}
	}

	.image-list {
		@gap: 10px;

		list-style: none;
		.clearfix;

		-webkit-column-count		: 1;
		column-count				: 1;
		-moz-column-count			: 1;
		-webkit-column-gap			: @gap;
		-moz-column-gap				: @gap;
		column-gap					: @gap;

		opacity: 0;

		.transition(~"opacity .2s ease-in-out");

		//.transition(~"opacity .2s ease-in-out");
		.clearfix;

		li {
			float: left;
			display: inline-block;
			width: 100%;
			margin-bottom: 10px;
			//break-inside: avoid-column;
			//-webkit-column-break-inside: avoid;
			//float: left;
		}

		a {
			background: gray;
			display: block;
			width: 100%;

			&:hover {
				background: @nmColor;
				& > * {
					opacity: .8;
				}
			}

			&.selected {
				background: @nmColor;
				& > * {
					opacity: .4;
				}
			}

			&> * {
				.user-select(none);
				.transition(~"opacity .2s ease-in-out");
			}

			img {
				display: block;
				width: 100%;
				height: auto;
			}
		}
	}

	&[class*="columns-"] {

		&:not(.open) {
			.image-list {
				opacity: 0;
				.transition(none);
			}
		}

		.image-list {
			opacity: 1;
		}
	}

	&.columns-2 {
		.image-list {
			column-count			: 2;
			-webkit-column-count	: 2;
			-moz-column-count		: 2;
		}
	}

	&.columns-3 {
		.image-list {
			column-count			: 3;
			-webkit-column-count	: 3;
			-moz-column-count		: 3;
		}
	}

	&.columns-4 {
		.image-list {
			column-count			: 4;
			-webkit-column-count	: 4;
			-moz-column-count		: 4;
		}
	}

	> nav {
		@width: 80;

		position: absolute;
		left: -@width / @em;
		top: 50%;
		width: @width / @em;
		margin-top: -@line * 3 / @em;

		background: @editorSidebarBg;
		text-align: right;

		ul {
			margin: 0;
			padding: 0;
			list-style: none;

			color: #fff;
		}

		li {
			padding: 10 / @em;
		}
	}
}

.project-type-list {
	position: absolute;
	top: 50%;
	left: 50%;
	width: 50%;
	list-style: none;
	margin-left: -25%;
	margin-top: -@line * 3 / @em;
	overflow: hidden;

	li {
		display: block;
		float: left;
		width: 25%;
		text-align: center;

		a {
			display: block;
			.aller;
			.small-caps;
			color: @btnColor;

			&:before {
				display: block;
				width: 100%;

				.icon-large;
				padding: (@line * .5 / @icon-large * 1em) 0;
				color: @gray;
			}

			&:hover,
			&:focus {
				color: @btnHover;

				&:before {
					color: @nmColor;
				}
			}
		}

		a {
			&.excursion:before {
				.icon-excursion;
			}

			&.exhibition:before {
				.icon-exhibition;
			}

			&.project:before {
				.icon-project;
			}

			&.workshop:before {
				.icon-workshop;
			}
		}
	}
}

/*
 *
 *  Four-column grid active
 *  ----------------------------------------
 *  Margin   | #  1   2   3   4   |   Margin
 *  5.55555% | %  25  50  75  100 | 5.55555%
 *
 */