// Generated by CoffeeScript 1.6.2
(function($) {
  var resizeEvents, resizeIframes, resizeParentOrChilds;

  resizeEvents = {};
  $(window).on('resize', function() {
    var callback, key, _results;

    _results = [];
    for (key in resizeEvents) {
      callback = resizeEvents[key];
      if (callback && $.isFunction(callback)) {
        _results.push(callback());
      } else {
        _results.push(void 0);
      }
    }
    return _results;
  });
  $.addOnWindowResize = function(key, callback) {
    if ($.isFunction(callback)) {
      return resizeEvents[key] = callback;
    }
  };
  $.removeOnWindowResize = function(key) {
    if (resizeEvents[key]) {
      return delete resizeEvents[key];
    }
  };
  /*
  	 # @example
  	 #	resizeParentOrChilds([
  	 #		# resize .group-image > img to .group-image.width()
  	 #		{
  	 #			parent: '.group-image'
  	 #			child: 'img'
  	 #			resize: 'child'
  	 #		},
  	 #		# resize .statement to (.statement > p).width()
  	 #		{
  	 #			parent: '.statement'
  	 #			child: 'p'
  	 #			resize: 'parent'
  	 #		}	 
  	 #	]);
  	 #
  */

  resizeParentOrChilds = function(els) {
    if (!els) {
      return;
    }
    return $.each(els, function(i, el) {
      var $child, $parent, childHeight, childWidth, parentHeight, parentWidth;

      $parent = $(el.parent);
      $child = $(el.child, $parent);
      if (!$child.length) {
        return;
      }
      parentWidth = $parent.width();
      parentHeight = $parent.height();
      childWidth = $child.outerWidth(true);
      if ($child.length > 1) {
        childHeight = 0;
        $child.each(function() {
          return childHeight += $(this).outerHeight(true);
        });
      } else {
        childHeight = $child.height();
      }
      if (el.resize === 'child') {
        return $child.height(parentWidth / childWidth * childHeight);
      } else if (el.resize === 'parent') {
        return $parent.height(childHeight);
      }
    });
  };
  resizeIframes = function() {
    var $iframes;

    $iframes = $('iframe', 'article.portfolio-detail');
    if (!$iframes.length) {
      return;
    }
    return $iframes.each(function(i, iframe) {
      var $iframe, attrHeight, attrWidth, scaleFactor, width;

      $iframe = $(iframe);
      attrWidth = $iframe.attr('width');
      attrHeight = $iframe.attr('height');
      if (!attrWidth || !attrHeight) {
        return;
      }
      width = $iframe.width();
      scaleFactor = width / attrWidth;
      return $iframe.height(attrHeight * scaleFactor);
    });
  };
  $(document).on('portfoliodetail:rendered', resizeIframes);
  $.addOnWindowResize('iframe', resizeIframes);
  return $(document).on('about:rendered', function() {
    return resizeParentOrChilds([
      {
        parent: '.group-image',
        child: 'img',
        resize: 'child'
      }, {
        parent: '.statement',
        child: 'p',
        resize: 'parent'
      }
    ]);
  });
})(jQuery);
